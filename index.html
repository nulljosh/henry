<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Henry - Portfolio Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;
            background: #f5f5f7;
            min-height: 100vh;
            padding: 20px;
            color: #1d1d1f;
        }

        :root {
            --accent: #007aff;
            --success: #34c759;
            --text-secondary: #86868b;
        }

        .back-button, .theme-toggle {
            position: fixed;
            top: 20px;
            width: 44px;
            height: 44px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 9999;
        }

        .back-button {
            left: 20px;
            text-decoration: none;
            font-size: 24px;
        }

        .theme-toggle {
            right: 20px;
            font-size: 20px;
            cursor: pointer;
            border: none;
        }

        .back-button:hover, .theme-toggle:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: scale(1.05);
        }

        body.dark {
            background: #1d1d1f;
            color: #f5f5f7;
            --text-secondary: #98989d;
        }

        body.dark .glass-card {
            background: #2c2c2e;
            border-color: rgba(255, 255, 255, 0.1);
        }

        body.dark h1, body.dark h2 {
            color: #f5f5f7;
        }

        body.dark p {
            color: #98989d;
        }

        body.dark table {
            background: #2c2c2e;
        }

        body.dark thead {
            background: #1d1d1f;
        }

        body.dark th {
            color: #98989d;
        }

        body.dark td {
            color: #f5f5f7;
            border-top-color: rgba(255, 255, 255, 0.1);
        }

        body.dark tbody tr:hover {
            background: #3a3a3c;
        }

        body.dark tbody tr:last-child td {
            background: #1d1d1f;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .glass-card {
            background: white;
            border-radius: 24px;
            border: 1px solid rgba(0, 0, 0, 0.05);
            padding: 32px;
            margin-bottom: 24px;
            box-shadow: 0 2px 16px rgba(0, 0, 0, 0.08);
        }

        .hero-card {
            text-align: center;
            padding: 48px 32px;
            position: relative;
            overflow: hidden;
        }

        .hero-graph {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.15;
            z-index: 0;
            cursor: pointer;
        }

        .graph-dot {
            transition: opacity 0.2s;
        }

        .graph-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 10;
        }

        .graph-tooltip-date {
            font-size: 11px;
            opacity: 0.7;
            margin-bottom: 2px;
        }

        .graph-tooltip-value {
            font-size: 14px;
        }

        .hero-title {
            font-size: 64px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            position: relative;
            z-index: 1;
        }

        .hero-logo {
            opacity: 0.9;
        }

        .hero-subtitle {
            font-size: 26px;
            font-weight: 600;
            margin-bottom: 32px;
            position: relative;
            z-index: 1;
        }

        .hero-pill {
            display: inline-flex;
            gap: 12px;
            align-items: center;
            justify-content: center;
            background: rgba(0, 122, 255, 0.1);
            padding: 12px 24px;
            border-radius: 12px;
            position: relative;
            z-index: 1;
        }

        .hero-metric {
            text-align: center;
        }

        .hero-metric-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent);
        }

        .hero-metric-label.target {
            color: var(--success);
        }

        .hero-metric-value {
            font-size: 24px;
            font-weight: 700;
        }

        .portfolio-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 20px;
        }

        .view-toggle {
            display: inline-flex;
            padding: 4px;
            border-radius: 999px;
            background: rgba(0, 0, 0, 0.06);
            border: 1px solid rgba(0, 0, 0, 0.08);
        }

        .view-toggle button {
            font-size: 13px;
            font-weight: 600;
            padding: 6px 14px;
            border: none;
            border-radius: 999px;
            background: transparent;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #1d1d1f;
        }

        .view-toggle button.active {
            background: #007aff;
            color: #f5f5f7;
            box-shadow: 0 4px 10px rgba(0, 122, 255, 0.25);
        }

        body.dark .view-toggle {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
        }

        body.dark .view-toggle button {
            color: #f5f5f7;
        }

        body.dark .view-toggle button.active {
            background: rgba(10, 132, 255, 0.85);
            box-shadow: 0 4px 12px rgba(10, 132, 255, 0.3);
        }

        .portfolio-views {
            position: relative;
        }

        .portfolio-pie-view {
            display: flex;
            gap: 32px;
            align-items: center;
            flex-wrap: wrap;
        }

        .pie-chart-wrapper {
            position: relative;
            width: 260px;
            height: 260px;
            display: grid;
            place-items: center;
        }

        .pie-chart {
            width: 260px;
            height: 260px;
            border-radius: 50%;
            position: relative;
            box-shadow: 0 10px 24px rgba(0, 0, 0, 0.08);
        }

        .pie-center-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-weight: 700;
            font-size: 20px;
            color: #1d1d1f;
            padding: 14px 18px;
            border-radius: 18px;
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(0, 0, 0, 0.05);
            min-width: 140px;
            line-height: 1.3;
        }

        body.dark .pie-center-label {
            background: rgba(44, 44, 46, 0.92);
            color: #f5f5f7;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .pie-center-label span {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: #6e6e73;
            text-transform: uppercase;
            letter-spacing: 0.4px;
        }

        body.dark .pie-center-label span {
            color: #d1d1d6;
        }

        .chart-legend {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 12px;
            flex: 1;
        }

        .chart-legend li {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(0, 0, 0, 0.04);
            border-radius: 12px;
            padding: 10px 14px;
        }

        body.dark .chart-legend li {
            background: rgba(255, 255, 255, 0.06);
        }

        .legend-swatch {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .legend-label {
            font-weight: 600;
            color: #1d1d1f;
        }

        body.dark .legend-label {
            color: #f5f5f7;
        }

        .legend-value {
            margin-left: auto;
            color: var(--text-secondary);
            font-weight: 500;
        }

        body.dark .legend-value {
            color: #d1d1d6;
        }

        .chart-legend li.active {
            background: rgba(0, 122, 255, 0.12);
            color: #007aff;
        }

        body.dark .chart-legend li.active {
            background: rgba(10, 132, 255, 0.25);
            color: #0a84ff;
        }

        .pie-logo-ring {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .pie-logo {
            position: absolute;
            transform: translate(-50%, -50%);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: grid;
            place-items: center;
            font-size: 15px;
            font-weight: 700;
            color: #1d1d1f;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.18), 0 0 0 3px #ffffff;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
        }

        .pie-logo span {
            pointer-events: none;
        }

        body.dark .pie-logo {
            color: #f5f5f7;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4), 0 0 0 2px rgba(0, 0, 0, 0.6);
        }

        .pie-logo:hover,
        .pie-logo:focus-visible {
            transform: translate(-50%, -50%) scale(1.12);
            box-shadow: 0 10px 22px rgba(0, 0, 0, 0.2), 0 0 0 3px rgba(255, 255, 255, 0.9);
        }

        body.dark .pie-logo:hover,
        body.dark .pie-logo:focus-visible {
            box-shadow: 0 10px 24px rgba(0, 0, 0, 0.5), 0 0 0 2px rgba(255, 255, 255, 0.5);
        }

        .portfolio-table-view {
            margin-top: 12px;
        }

        .hidden {
            display: none !important;
        }

        .earnings-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            margin-left: 8px;
            box-shadow: 0 0 0 2px #ffffff;
        }

        .earnings-badge[data-status="beat"] {
            background: #34c759;
        }

        .earnings-badge[data-status="miss"] {
            background: #ff3b30;
        }

        .earnings-badge[data-status="upcoming"] {
            background: #0a84ff;
        }

        .earnings-badge[data-status="neutral"] {
            background: rgba(142, 142, 147, 0.5);
        }

        body.dark .earnings-badge {
            box-shadow: 0 0 0 2px #1d1d1f;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .hero-divider {
            width: 1px;
            height: 40px;
            background: rgba(0, 0, 0, 0.1);
            margin: 0 12px;
        }

        .market-copy {
            font-size: 15px;
            line-height: 1.8;
            color: var(--text-secondary);
        }

        .market-insights-card {
            background: #ffffff;
            color: #1d1d1f;
            border: 1px solid rgba(0, 0, 0, 0.06);
            transition: background 0.3s ease, color 0.3s ease;
        }

        body.dark .market-insights-card {
            background: #2c2c2e;
            color: #f5f5f7;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .market-insights-toggle {
            width: 100%;
            background: transparent;
            border: none;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 20px;
            font-weight: 600;
            color: inherit;
            cursor: pointer;
            padding: 4px 0 8px;
        }

        .market-insights-toggle-icon {
            transition: transform 0.3s ease;
            font-size: 20px;
        }

        .market-insights-card.open .market-insights-toggle-icon {
            transform: rotate(180deg);
        }

        .market-insights-content {
            overflow: hidden;
            max-height: 0;
            opacity: 0;
            padding-top: 0;
            transition: max-height 0.4s ease, opacity 0.3s ease;
        }

        .market-insights-card.open .market-insights-content {
            opacity: 1;
            padding-top: 12px;
        }

        .market-insights-card .market-copy {
            color: #1d1d1f;
        }

        .market-insights-card .market-copy strong {
            color: #1d1d1f;
        }

        body.dark .market-insights-card .market-copy,
        body.dark .market-insights-card .market-copy strong {
            color: #f5f5f7;
        }

        .market-pulse {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 16px;
        }

        .market-pulse-item {
            background: rgba(0, 0, 0, 0.04);
            border-radius: 14px;
            padding: 18px 20px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            font-size: 18px;
            font-weight: 700;
        }

        .market-pulse-item span {
            display: block;
            margin-top: 8px;
            text-transform: none;
            letter-spacing: normal;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        body.dark .market-pulse-item {
            background: rgba(255, 255, 255, 0.06);
        }

        body.dark .market-pulse-item span {
            color: #d1d1d6;
        }

        .hidden-row {
            display: none;
        }

        .top-gain-badge {
            display: inline-block;
            margin-left: 8px;
            padding: 2px 8px;
            border-radius: 999px;
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            background: rgba(0, 122, 255, 0.12);
            color: var(--accent);
        }

        .top-gain-row td {
            background: linear-gradient(135deg, rgba(0, 122, 255, 0.08), rgba(0, 122, 255, 0.02));
        }

        .payday-highlight {
            background: rgba(52, 199, 89, 0.1);
            border: 1px solid rgba(52, 199, 89, 0.3);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .payday-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--success);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .payday-amount {
            font-size: 24px;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 4px;
        }

        .payday-note {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .payday-date {
            font-size: 13px;
            font-weight: 600;
            color: #1d1d1f;
            margin-bottom: 6px;
        }

        body.dark .payday-date {
            color: #f5f5f7;
        }

        .progress-summary {
            margin-bottom: 24px;
        }

        .progress-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .progress-labels span:nth-child(2) {
            color: var(--accent);
        }

        .progress-bar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 12px;
            height: 20px;
            overflow: hidden;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .progress-bar-fill {
            background: rgba(0, 122, 255, 0.85);
            height: 100%;
            width: 24%;
            border-radius: 12px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 122, 255, 0.3);
        }

        .heart {
            color: #ff3b30;
            animation: heartbeat 2s ease-in-out infinite;
            display: inline-block;
            vertical-align: middle;
        }

        @keyframes heartbeat {
            0% { transform: scale(1); }
            10% { transform: scale(1.2); }
            20% { transform: scale(1); }
            30% { transform: scale(1.15); }
            40% { transform: scale(1); }
            100% { transform: scale(1); }
        }

        .site-footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #8e8e93;
            font-size: 14px;
        }

        .site-footer a {
            color: inherit;
            text-decoration: none;
            font-weight: 600;
        }

        .site-footer a:hover {
            text-decoration: underline;
        }

        h1 {
            color: #1d1d1f;
            font-size: 52px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -1px;
        }

        h2 {
            color: #6e6e73;
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 20px;
            letter-spacing: -0.2px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            overflow: hidden;
        }

        thead {
            background: #f5f5f7;
        }

        th {
            padding: 16px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #86868b;
            cursor: pointer;
            user-select: none;
            position: relative;
            transition: color 0.2s ease;
        }

        th:hover {
            color: #007aff;
        }

        th.sortable::after {
            content: ' ‚Üï';
            opacity: 0.3;
            font-size: 10px;
        }

        th.sorted-asc::after {
            content: ' ‚Üë';
            opacity: 1;
            color: #007aff;
        }

        th.sorted-desc::after {
            content: ' ‚Üì';
            opacity: 1;
            color: #007aff;
        }

        td {
            padding: 16px;
            border-top: 1px solid rgba(0, 0, 0, 0.05);
            font-size: 15px;
        }

        tbody tr:hover {
            background: #f5f5f7;
        }

        tbody tr:last-child td {
            font-weight: 600;
            background: #f5f5f7;
        }

        a {
            color: #007aff;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        a:hover {
            color: #0051d5;
        }

        .future-expense {
            opacity: 0.6;
            font-style: italic;
        }

        .earnings-badge {
            background: #007aff;
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 6px;
            font-weight: 600;
            margin-left: 4px;
            white-space: nowrap;
        }

        .earnings-badge.completed {
            background: #8e8e93;
        }

        .earnings-badge.upcoming-soon {
            background: #34c759;
        }

        @media (max-width: 768px) {
            body {
                padding: 12px;
            }

            .glass-card {
                padding: 20px;
                border-radius: 16px;
            }

            h1 {
                font-size: 32px;
            }

            h2 {
                font-size: 22px;
            }

            table {
                font-size: 12px;
            }

            th, td {
                padding: 10px 6px;
            }

            .back-button, .theme-toggle {
                top: 12px;
            }

            .portfolio-pie-view {
                flex-direction: column;
                align-items: center;
            }

            .pie-chart {
                width: 220px;
                height: 220px;
            }

            .pie-center-label {
                min-width: 120px;
                font-size: 18px;
            }

            .chart-legend {
                width: 100%;
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            }
        }

    </style>
</head>
<body>
    <a href="https://heyitsmejosh.com" class="back-button">‚Üê</a>
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode">
        <span id="themeIcon">‚òÄÔ∏è</span>
    </button>

    <script>
        const holdingsData = [
            { symbol: 'PLTR', logo: 'data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 48 48%22 fill=%22white%22><path d=%22M24 4c-7.7 0-14 6.3-14 14s6.3 14 14 14 14-6.3 14-14S31.7 4 24 4zm0 22c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zm0 6l-8 12h16l-8-12z%22/></svg>', shares: 0.4219, price: 178.04, currentValue: 75, targetPrice: 450, targetValue: 190, gainPercent: 153, dailyChangePercent: 2.4, color: '#4b5d86', url: 'https://finance.yahoo.com/quote/PLTR', earningsStatus: 'beat', earningsLabel: 'Earnings beat Nov 3' },
            { symbol: 'HOOD', logo: 'data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 48 48%22 fill=%22white%22><path d=%22M24 6C15 15 12 24 12 30c0 6.6 5.4 12 12 12s12-5.4 12-12c0-6-3-15-12-24z%22/></svg>', shares: 0.4129, price: 131.64, currentValue: 54, targetPrice: 300, targetValue: 124, gainPercent: 130, dailyChangePercent: -0.8, color: '#27c998', url: 'https://finance.yahoo.com/quote/HOOD', earningsStatus: 'beat', earningsLabel: 'Earnings beat Nov 5' },
            { symbol: 'NVDA', logo: 'data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 48 48%22 fill=%22white%22><path d=%22M24 10C14 10 6 18 6 28h6c0-6.6 5.4-12 12-12s12 5.4 12 12h6c0-10-8-18-18-18zm0 12c-3.3 0-6 2.7-6 6h6v12h6V28c0-3.3-2.7-6-6-6z%22/></svg>', shares: 0.2541, price: 189.49, currentValue: 48, targetPrice: 500, targetValue: 127, gainPercent: 165, dailyChangePercent: 1.1, color: '#9dd866', url: 'https://finance.yahoo.com/quote/NVDA', earningsStatus: 'upcoming', earningsLabel: 'Earnings Nov 19' },
            { symbol: 'GOOGL', logo: 'data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 48 48%22><path fill=%22%23fff%22 d=%22M24 9c3.7 0 6.8 1.5 9 3.7l6.4-6.4C35 2.6 29.9 0 24 0 14.6 0 6.5 5.6 2.5 13.8l7.5 5.8C11.8 13.8 17.3 9 24 9z%22/><path fill=%22%23fff%22 d=%22M46.5 24.5c0-1.4-.1-2.8-.4-4.1H24v8h12.7c-.6 3.2-2.6 6-5.6 7.8l8.5 6.6c5-4.6 8-11.3 8-18.3z%22/><path fill=%22%23fff%22 d=%22M10 28.8c-1.2-3.6-1.2-7.5 0-11.1L2.5 11C-1.4 18.6-1.4 27.4 2.5 35l7.5-6.2z%22/><path fill=%22%23fff%22 d=%22M24 48c6.5 0 12-2.1 16-5.7l-8.5-6.6c-2.3 1.5-5.3 2.4-8.5 2.4-6.7 0-12.2-4.8-13.9-11.2l-7.6 5.8C6.5 42.4 14.6 48 24 48z%22/></svg>', shares: 0.1485, price: 285.60, currentValue: 42, targetPrice: 550, targetValue: 82, gainPercent: 95, dailyChangePercent: 0.6, color: '#5c8df6', url: 'https://finance.yahoo.com/quote/GOOGL', earningsStatus: 'beat', earningsLabel: 'Earnings beat Oct 29' },
            { symbol: 'TSLA', logo: 'data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 48 48%22 fill=%22white%22><path d=%22M24 5C18 5 12 7 8 9l2 4c3.3-1.7 7.7-3 14-3s10.7 1.3 14 3l2-4c-4-2-10-4-16-4zm0 8c-4.4 0-8.5.7-12 2l2 28 10-8 10 8 2-28c-3.5-1.3-7.6-2-12-2z%22/></svg>', shares: 0.1122, price: 448.80, currentValue: 50, targetPrice: 800, targetValue: 90, gainPercent: 80, dailyChangePercent: -1.9, color: '#ff7676', url: 'https://finance.yahoo.com/quote/TSLA', earningsStatus: 'miss', earningsLabel: 'Earnings missed Oct 23' },
            { symbol: 'AAPL', logo: 'data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 48 48%22 fill=%22white%22><path d=%22M32 2c-2.4.1-5.2 1.6-6.8 3.5-1.5 1.8-2.7 4.7-2.3 7.4 2.7.2 5.4-1.4 7-3.3 1.6-1.9 2.7-4.8 2.1-7.6zm2.2 12.2c-3.8 0-5.4 2.5-8 2.5s-4.5-2.4-7.8-2.4c-4 0-8.4 2.8-10.6 7.8-3.7 8.1-.9 20.1 2.6 26.7 1.8 3.2 3.9 6.7 6.8 6.6 2.7-.1 3.6-1.7 6.8-1.7s4 1.7 6.8 1.6c2.8-.1 4.6-3.2 6.4-6.4 2-3.5 2.8-6.9 2.9-7.1-.1-.1-5.5-2.1-5.6-8.4-.1-5.3 4.3-7.8 4.5-8-.2-.2-4.5-2.3-4.4-8.2.1-5.1 4-7.5 4.2-7.6-2.4-3.6-6.1-4-7-4.1z%22/></svg>', shares: 0.6338, price: 271.63, currentValue: 172, targetPrice: 500, targetValue: 317, gainPercent: 184, dailyChangePercent: 0.4, color: '#c7d2ec', url: 'https://finance.yahoo.com/quote/AAPL', earningsStatus: 'beat', earningsLabel: 'Earnings beat Oct 30' },
            { symbol: 'SPY', logo: 'data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 48 48%22 fill=%22white%22><path d=%22M6 6h36v8H6zM6 20h20v8H6zM6 34h28v8H6z%22/></svg>', shares: 0.3378, price: 671.99, currentValue: 227, targetPrice: 1100, targetValue: 372, gainPercent: 64, dailyChangePercent: 0.2, color: '#4f75b7', url: 'https://finance.yahoo.com/quote/SPY', earningsStatus: 'neutral', earningsLabel: 'Index fund' },
            { symbol: 'SBUX', logo: 'data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 48 48%22><circle cx=%2224%22 cy=%2224%22 r=%2220%22 fill=%22%23fff%22/><path fill=%2200704a%22 d=%22M24 5C14.6 5 6 13.6 6 23h6c0-6.6 5.4-12 12-12s12 5.4 12 12h6c0-9.4-8.6-18-18-18zm0 12c-3.3 0-6 2.7-6 6h6v12h6V23c0-3.3-2.7-6-6-6z%22/></svg>', shares: 0.1432, price: 82.71, currentValue: 12, targetPrice: 130, targetValue: 19, gainPercent: 58, dailyChangePercent: -0.3, color: '#57b58a', url: 'https://finance.yahoo.com/quote/SBUX', earningsStatus: 'neutral', earningsLabel: 'Holding steady' },
            { symbol: 'V', logo: 'data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 48 48%22 fill=%22white%22><path d=%22M8 12l8 24h9l8-24h-7l-5 18-5-18H8z%22/></svg>', shares: 0.2570, price: 336.34, currentValue: 86, targetPrice: 550, targetValue: 141, gainPercent: 64, dailyChangePercent: 0.9, color: '#4667bb', url: 'https://finance.yahoo.com/quote/V', earningsStatus: 'neutral', earningsLabel: 'Holding steady' },
            { symbol: 'BTC', logo: 'data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 48 48%22 fill=%22white%22><path d=%22M29 4h-2V0h-4v4h-3V0h-4v4H9v6h2v22H9v6h7v4h4v-4h3v4h4v-4h2c7.2 0 13-5.8 13-13 0-4.9-2.7-9.1-6.6-11.3C32.5 15.5 35 12 35 8c0-2.2-.9-4.2-2.3-5.7C31.1 1 30.1 0 29 0v4zM24 12h3c2.8 0 5 2.2 5 5s-2.2 5-5 5h-3v-10zm0 18h4c3.3 0 6 2.7 6 6s-2.7 6-6 6h-4V30z%22/></svg>', shares: 0.0001927, price: 101631, currentValue: 20, targetPrice: 250000, targetValue: 48, gainPercent: 140, dailyChangePercent: 3.5, color: '#ffb76b', url: 'https://www.coinbase.com/price/bitcoin', earningsStatus: 'neutral', earningsLabel: 'Crypto holding' }
        ];

        const formatCurrency = (value) => `$${Math.round(value).toLocaleString('en-US')}`;
        const formatPrice = (value) => `$${value.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        const formatShares = (value) => {
            const fixed = value.toFixed(4);
            return fixed.replace(/\.?0+$/, '');
        };
        const formatPercent = (value) => `${value >= 0 ? '+' : ''}${Number(value).toFixed(1)}%`;
        const getContrastColor = (hex) => {
            const clean = hex.replace('#', '');
            const expanded = clean.length === 3 ? clean.split('').map(ch => ch + ch).join('') : clean;
            const r = parseInt(expanded.substring(0, 2), 16);
            const g = parseInt(expanded.substring(2, 4), 16);
            const b = parseInt(expanded.substring(4, 6), 16);
            const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
            return luminance > 0.6 ? '#1d1d1f' : '#f5f5f7';
        };

        function toggleTheme() {
            document.body.classList.toggle('dark');
            const isDark = document.body.classList.contains('dark');
            document.getElementById('themeIcon').textContent = isDark ? 'üåô' : '‚òÄÔ∏è';
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        const theme = localStorage.getItem('theme');
        if (theme === 'dark' || (!theme && matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.body.classList.add('dark');
            document.getElementById('themeIcon').textContent = 'üåô';
        }

        matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            if (!theme) {
                document.body.classList.toggle('dark', e.matches);
                document.getElementById('themeIcon').textContent = e.matches ? 'üåô' : '‚òÄÔ∏è';
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            const table = document.getElementById('stockTable');
            const headers = table ? table.querySelectorAll('th') : [];
            const tbody = table ? table.querySelector('tbody') : null;
            const totalsRow = table ? table.querySelector('tfoot tr') : null;
            const pieHoldings = [...holdingsData].sort((a, b) => b.currentValue - a.currentValue);
            const tableHoldings = [...holdingsData].sort((a, b) => b.dailyChangePercent - a.dailyChangePercent);
            const symbolLinks = {
                PLTR: 'https://finance.yahoo.com/quote/PLTR',
                HOOD: 'https://finance.yahoo.com/quote/HOOD',
                NVDA: 'https://finance.yahoo.com/quote/NVDA',
                GOOGL: 'https://finance.yahoo.com/quote/GOOGL',
                TSLA: 'https://finance.yahoo.com/quote/TSLA',
                AAPL: 'https://finance.yahoo.com/quote/AAPL',
                SPY: 'https://finance.yahoo.com/quote/SPY',
                SBUX: 'https://finance.yahoo.com/quote/SBUX',
                V: 'https://finance.yahoo.com/quote/V',
                BTC: 'https://www.coinbase.com/price/bitcoin'
            };

            const currentTotal = holdingsData.reduce((sum, holding) => sum + holding.currentValue, 0);
            const targetTotal = holdingsData.reduce((sum, holding) => sum + holding.targetValue, 0);

            const heroCurrent = document.getElementById('heroCurrentValue');
            const heroTarget = document.getElementById('heroTargetValue');
            if (heroCurrent) heroCurrent.textContent = formatCurrency(currentTotal);
            if (heroTarget) heroTarget.textContent = formatCurrency(targetTotal);
 
            if (tbody) {
                tbody.innerHTML = '';
                tableHoldings.forEach(item => {
                    const tr = document.createElement('tr');

                    const symbolCell = document.createElement('td');
                    const link = document.createElement('a');
                    link.href = item.url || symbolLinks[item.symbol] || '#';
                    link.target = '_blank';
                    link.rel = 'noopener';
                    link.textContent = item.symbol;
                    symbolCell.appendChild(link);

                    if (item.earningsStatus) {
                        const badge = document.createElement('span');
                        badge.className = 'earnings-badge';
                        badge.dataset.status = item.earningsStatus;
                        badge.setAttribute('role', 'img');
                        badge.setAttribute('aria-label', item.earningsLabel || item.earningsStatus);
                        badge.title = item.earningsLabel || item.earningsStatus;
                        symbolCell.appendChild(badge);
                    }

                    const sharesCell = document.createElement('td');
                    sharesCell.textContent = formatShares(item.shares);

                    const priceCell = document.createElement('td');
                    priceCell.textContent = formatPrice(item.price);

                    const dailyCell = document.createElement('td');
                    const dailyValue = item.dailyChangePercent;
                    const dailySign = dailyValue >= 0 ? '+' : '';
                    dailyCell.textContent = `${dailySign}${dailyValue.toFixed(2)}%`;
                    dailyCell.style.color = dailyValue > 0 ? '#2ecc71' : dailyValue < 0 ? '#ff3b30' : 'inherit';
                    dailyCell.style.fontWeight = '600';

                    const currentCell = document.createElement('td');
                    currentCell.textContent = formatCurrency(item.currentValue);

                    const targetPriceCell = document.createElement('td');
                    targetPriceCell.textContent = formatPrice(item.targetPrice);

                    const targetValueCell = document.createElement('td');
                    targetValueCell.textContent = formatCurrency(item.targetValue);

                    const gainCell = document.createElement('td');
                    gainCell.textContent = formatPercent(item.gainPercent);

                    tr.appendChild(symbolCell);
                    tr.appendChild(sharesCell);
                    tr.appendChild(priceCell);
                    tr.appendChild(dailyCell);
                    tr.appendChild(currentCell);
                    tr.appendChild(targetPriceCell);
                    tr.appendChild(targetValueCell);
                    tr.appendChild(gainCell);

                    tbody.appendChild(tr);
                });
            }

            if (totalsRow) {
                const currentCell = totalsRow.querySelector('td:nth-child(5)');
                const targetCell = totalsRow.querySelector('td:nth-child(7)');
                const gainCell = totalsRow.querySelector('td:nth-child(8)');
                if (currentCell) currentCell.innerHTML = `<strong>${formatCurrency(currentTotal)}</strong>`;
                if (targetCell) targetCell.innerHTML = `<strong>${formatCurrency(targetTotal)}</strong>`;
                if (gainCell) {
                    const totalGainPercent = Math.round(((targetTotal - currentTotal) / currentTotal) * 100);
                    gainCell.innerHTML = `<strong>+${totalGainPercent}%</strong>`;
                }
            }

            const summaryTotal = document.getElementById('summaryTotalPortfolio');
            const summaryTarget = document.getElementById('summaryTargetPortfolio');
            const summaryGain = document.getElementById('summaryPotentialGain');
            if (summaryTotal) summaryTotal.textContent = formatCurrency(867);
            if (summaryTarget) summaryTarget.textContent = formatCurrency(2098);
            if (summaryGain) {
                const netGain = 2098 - 867;
                const netGainPercent = Math.round((netGain / 867) * 100);
                summaryGain.textContent = `+${formatCurrency(netGain)} (+${netGainPercent}%)`;
            }

            const pieChart = document.getElementById('stockPieChart');
            const pieCenter = document.getElementById('stockPieCenter');
            const pieLegend = document.getElementById('stockPieLegend');
            const pieLogos = document.getElementById('stockPieLogos');
            const legendMap = {};
            const logoMap = {};
            let activeSymbol = null;

            const defaultCenter = () => {
                if (pieCenter) {
                    pieCenter.innerHTML = `${formatCurrency(currentTotal)}<span>Current</span>`;
                }
                if (pieChart) {
                    pieChart.style.boxShadow = '0 10px 24px rgba(0, 0, 0, 0.08)';
                }
                Object.values(legendMap).forEach(li => li.classList.remove('active'));
            };

            const activateSlice = (symbol) => {
                const item = holdingsData.find(entry => entry.symbol === symbol);
                if (!item || !pieCenter) return;
                activeSymbol = symbol;
                pieCenter.innerHTML = `${formatCurrency(item.currentValue)}<span>${item.symbol} ‚Ä¢ ${formatPercent(item.gainPercent)} target</span>`;
                if (pieChart) {
                    pieChart.style.boxShadow = '0 18px 40px rgba(0, 0, 0, 0.18), 0 0 0 6px rgba(0, 0, 0, 0.05)';
                }
                Object.entries(legendMap).forEach(([sym, li]) => {
                    li.classList.toggle('active', sym === symbol);
                });
            };

            const resetSlice = () => {
                activeSymbol = null;
                defaultCenter();
            };
            const toggleSlice = (symbol) => {
                if (activeSymbol === symbol) {
                    resetSlice();
                } else {
                    activateSlice(symbol);
                }
            };
            if (pieChart && pieCenter && pieLegend) {
                let start = 0;
                const segments = pieHoldings.map(item => {
                    const sweep = (item.currentValue / currentTotal) * 100;
                    const definition = `${item.color} ${start}% ${start + sweep}%`;
                    start += sweep;
                    return definition;
                });
                pieChart.style.background = `conic-gradient(${segments.join(', ')})`;
                pieCenter.innerHTML = `${formatCurrency(currentTotal)}<span>Current</span>`;

                pieLegend.innerHTML = '';
                if (pieLogos) {
                    pieLogos.innerHTML = '';
                }
                let angleAccumulator = 0;
                pieHoldings.forEach(item => {
                    const li = document.createElement('li');
                    const swatch = document.createElement('span');
                    swatch.className = 'legend-swatch';
                    swatch.style.background = item.color;

                    const label = document.createElement('span');
                    label.className = 'legend-label';
                    label.textContent = item.symbol;

                    const value = document.createElement('span');
                    value.className = 'legend-value';
                    value.textContent = formatCurrency(item.currentValue);

                    li.appendChild(swatch);
                    li.appendChild(label);
                    li.appendChild(value);
                    pieLegend.appendChild(li);
                    legendMap[item.symbol] = li;
                    li.tabIndex = 0;
                    li.setAttribute('role', 'button');
                    li.setAttribute('aria-label', `${item.symbol} ${formatCurrency(item.currentValue)}, ${formatPercent(item.gainPercent)} potential`);
                    const enterLegend = () => activateSlice(item.symbol);
                    const leaveLegend = () => resetSlice();
                    li.addEventListener('mouseenter', enterLegend);
                    li.addEventListener('mouseleave', leaveLegend);
                    li.addEventListener('focus', enterLegend);
                    li.addEventListener('blur', leaveLegend);
                    li.addEventListener('click', () => toggleSlice(item.symbol));
                });

                if (pieLogos) {
                    angleAccumulator = 0;
                    pieHoldings.forEach(item => {
                        const sweep = (item.currentValue / currentTotal) * 360;
                        const midAngle = angleAccumulator + sweep / 2;
                        const radians = (midAngle - 90) * (Math.PI / 180);
                        const radius = 110; // stay within wrapper bounds
                        const x = 130 + Math.cos(radians) * radius;
                        const y = 130 + Math.sin(radians) * radius;
                        const logo = document.createElement('div');
                        logo.className = 'pie-logo';
                        logo.style.background = item.color;
                        logo.style.color = getContrastColor(item.color);
                        logo.style.left = `${x}px`;
                        logo.style.top = `${y}px`;
                        logo.dataset.symbol = item.symbol;
                        logo.tabIndex = 0;
                        logo.setAttribute('role', 'button');
                        logo.setAttribute('aria-label', `${item.symbol} ${formatCurrency(item.currentValue)}, ${formatPercent(item.gainPercent)} potential`);
                        const span = document.createElement('span');
                        span.textContent = item.logo || item.symbol[0];
                        logo.appendChild(span);
                        pieLogos.appendChild(logo);
                        logoMap[item.symbol] = logo;
                        const enterLogo = () => activateSlice(item.symbol);
                        const leaveLogo = () => resetSlice();
                        logo.addEventListener('mouseenter', enterLogo);
                        logo.addEventListener('mouseleave', leaveLogo);
                        logo.addEventListener('focus', enterLogo);
                        logo.addEventListener('blur', leaveLogo);
                        logo.addEventListener('click', (e) => {
                            e.preventDefault();
                            toggleSlice(item.symbol);
                        });
                        angleAccumulator += sweep;
                    });
                }
                defaultCenter();
            }

            const pieView = document.getElementById('stockPieView');
            const tableView = document.getElementById('stockTableWrapper');
            const viewToggleButtons = document.querySelectorAll('[data-view-toggle]');

            function setPortfolioView(view) {
                if (!pieView || !tableView) return;
                if (view === 'table') {
                    pieView.classList.add('hidden');
                    tableView.classList.remove('hidden');
                } else {
                    pieView.classList.remove('hidden');
                    tableView.classList.add('hidden');
                }

                viewToggleButtons.forEach(btn => {
                    const isActive = btn.dataset.viewToggle === view;
                    btn.classList.toggle('active', isActive);
                    btn.setAttribute('aria-pressed', String(isActive));
                });

                if (view === 'pie') {
                    resetSlice();
                }
            }

            setPortfolioView('pie');
            defaultCenter();

            viewToggleButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const view = button.dataset.viewToggle;
                    setPortfolioView(view);
                });
            });

            const insightsCard = document.getElementById('marketInsightsCard');
            const insightsToggle = document.getElementById('marketInsightsToggle');
            const insightsContent = document.getElementById('marketInsightsContent');
            if (insightsCard) {
                insightsCard.classList.remove('open');
            }
            if (insightsContent) {
                insightsContent.style.maxHeight = '0px';
                insightsContent.setAttribute('aria-hidden', 'true');
            }
            if (insightsToggle && insightsContent && insightsCard) {
                insightsToggle.addEventListener('click', () => {
                    const expanded = insightsToggle.getAttribute('aria-expanded') === 'true';
                    insightsToggle.setAttribute('aria-expanded', String(!expanded));
                    insightsCard.classList.toggle('open', !expanded);
                    if (!expanded) {
                        insightsContent.style.maxHeight = `${insightsContent.scrollHeight}px`;
                        insightsContent.setAttribute('aria-hidden', 'false');
                    } else {
                        insightsContent.style.maxHeight = '0px';
                        insightsContent.setAttribute('aria-hidden', 'true');
                    }
                });

                window.addEventListener('resize', () => {
                    if (insightsCard.classList.contains('open')) {
                        insightsContent.style.maxHeight = `${insightsContent.scrollHeight}px`;
                    }
                });
            }

            headers.forEach((header, index) => {
                header.classList.add('sortable');
                header.dataset.column = index;
                header.dataset.order = 'desc';
            });

            function getCellValue(row, index) {
                const cell = row ? row.cells[index] : null;
                if (!cell) return '';
                const text = cell.textContent.trim();
                if (text.startsWith('$')) return parseFloat(text.replace(/[$,]/g, '')) || 0;
                if (text.includes('%')) return parseFloat(text.replace(/[+%]/g, '')) || 0;
                if (!isNaN(text) && text !== '') return parseFloat(text);
                return text.toLowerCase();
            }

            function sortTable(column, order) {
                if (!tbody) return;
                const rows = Array.from(tbody.querySelectorAll('tr'));
                rows.sort((a, b) => {
                    const aVal = getCellValue(a, column);
                    const bVal = getCellValue(b, column);
                    if (typeof aVal === 'number' && typeof bVal === 'number') {
                        return order === 'asc' ? aVal - bVal : bVal - aVal;
                    }
                    return order === 'asc' ? (aVal > bVal ? 1 : aVal < bVal ? -1 : 0) : (aVal < bVal ? 1 : aVal > bVal ? -1 : 0);
                });

                tbody.innerHTML = '';
                rows.forEach(row => tbody.appendChild(row));
            }

            headers.forEach(header => {
                header.addEventListener('click', () => {
                    const column = parseInt(header.dataset.column, 10);
                    const newOrder = header.dataset.order === 'asc' ? 'desc' : 'asc';

                    headers.forEach(h => {
                        h.classList.remove('sorted-asc', 'sorted-desc');
                        h.dataset.order = 'desc';
                    });

                    header.classList.add(newOrder === 'asc' ? 'sorted-asc' : 'sorted-desc');
                    header.dataset.order = newOrder;
                    sortTable(column, newOrder);
                });
            });

            const gainHeader = headers[7];
            if (gainHeader) {
                gainHeader.classList.add('sorted-desc');
                gainHeader.dataset.order = 'desc';
                sortTable(6, 'desc');
            }

            const graph = document.getElementById('heroGraph');
            const dot = document.getElementById('graphDot');
            const tooltip = document.getElementById('graphTooltip');

            if (graph && dot && tooltip) {
                const graphPoints = [
                    {x:0,y:220,val:300,date:'Oct 28'}, {x:100,y:210,val:400,date:'Oct 29'}, {x:200,y:195,val:500,date:'Oct 30'},
                    {x:300,y:185,val:600,date:'Oct 31'}, {x:400,y:165,val:716,date:'Nov 1'}, {x:500,y:150,val:900,date:'Nov 2'},
                    {x:600,y:120,val:1200,date:'Nov 3'}, {x:700,y:95,val:1450,date:'Nov 4'}, {x:800,y:60,val:1720,date:'Nov 5'}
                ];

                const updateGraph = (clientX, clientY) => {
                    const rect = graph.getBoundingClientRect();
                    const x = ((clientX - rect.left) / rect.width) * 800;
                    const y = ((clientY - rect.top) / rect.height) * 300;

                    if (y > 250 || y < 40) return;

                    let i = 0;
                    while (i < graphPoints.length - 1 && graphPoints[i + 1].x < x) i++;
                    const p1 = graphPoints[i], p2 = graphPoints[i + 1] || p1;
                    const ratio = (x - p1.x) / (p2.x - p1.x || 1);
                    const graphY = p1.y + (p2.y - p1.y) * ratio;
                    const val = Math.round(p1.val + (p2.val - p1.val) * ratio);
                    dot.setAttribute('cx', x);
                    dot.setAttribute('cy', graphY);
                    dot.setAttribute('opacity', '1');
                    const nearestPoint = graphPoints[Math.min(i + (ratio > 0.5 ? 1 : 0), graphPoints.length - 1)];
                    tooltip.innerHTML = `<div class="graph-tooltip-date">${nearestPoint.date}</div><div class="graph-tooltip-value">$${val}</div>`;
                    tooltip.style.left = clientX - rect.left + 'px';
                    tooltip.style.top = clientY - rect.top - 40 + 'px';
                    tooltip.style.opacity = '1';
                };

                const hideGraph = () => {
                    dot.setAttribute('opacity', '0');
                    tooltip.style.opacity = '0';
                };

                graph.addEventListener('mousemove', e => updateGraph(e.clientX, e.clientY));
                graph.addEventListener('mouseleave', hideGraph);
                graph.addEventListener('touchstart', e => { e.preventDefault(); updateGraph(e.touches[0].clientX, e.touches[0].clientY); });
                graph.addEventListener('touchmove', e => { e.preventDefault(); updateGraph(e.touches[0].clientX, e.touches[0].clientY); });
                graph.addEventListener('touchend', e => { e.preventDefault(); hideGraph(); });
            }

            // Payday countdown
            function updatePaydayCountdown() {
                const now = new Date();
                const paydays = [
                    new Date('2025-11-19T00:00:00'),
                    new Date('2025-12-17T00:00:00'),
                    new Date('2026-01-19T00:00:00')
                ];
                let nextPayday = null;
                for (const payday of paydays) {
                    if (payday > now) {
                        nextPayday = payday;
                        break;
                    }
                }
                if (!nextPayday) {
                    const el = document.getElementById('paydayCountdown');
                    const dateLabel = document.getElementById('paydayDateLabel');
                    if (el) el.textContent = 'No upcoming payday';
                    if (dateLabel) dateLabel.textContent = '';
                    return;
                }
                const diff = nextPayday - now;
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const el = document.getElementById('paydayCountdown');
                if (el) {
                    if (days === 0 && hours === 0) {
                        el.textContent = 'Today!';
                    } else if (days === 0) {
                        el.textContent = `${hours}h`;
                    } else if (days === 1) {
                        el.textContent = `1 day, ${hours}h`;
                    } else {
                        el.textContent = `${days} days`;
                    }
                }
                const dateLabel = document.getElementById('paydayDateLabel');
                if (dateLabel) {
                    const formattedDate = nextPayday.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                    const weekday = nextPayday.toLocaleDateString('en-US', { weekday: 'short' });
                    dateLabel.textContent = `${formattedDate} ¬∑ ${weekday}`;
                }
            }
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', updatePaydayCountdown);
            } else {
                updatePaydayCountdown();
            }
            setInterval(updatePaydayCountdown, 60000);
        });

    </script>

    <div class="container">
        <div class="glass-card hero-card">
            <svg id="heroGraph" class="hero-graph" viewBox="0 0 800 300" preserveAspectRatio="none">
                <defs>
                    <linearGradient id="graphGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" stop-color="#007aff" stop-opacity="0.3" />
                        <stop offset="100%" stop-color="#007aff" stop-opacity="0" />
                    </linearGradient>
                </defs>
                <path d="M0,220 L100,210 L200,195 L300,185 L400,165 L500,150 L600,120 L700,95 L800,60 L800,300 L0,300 Z" fill="url(#graphGradient)"/>
                <path d="M0,220 L100,210 L200,195 L300,185 L400,165 L500,150 L600,120 L700,95 L800,60" stroke="#007aff" stroke-width="2" fill="none" stroke-linejoin="round" stroke-linecap="round"/>
                <circle id="graphDot" class="graph-dot" r="6" fill="#007aff" opacity="0"/>
            </svg>
            <div id="graphTooltip" class="graph-tooltip"></div>
            <h1 class="hero-title">
                Henry
                <svg width="56" height="56" viewBox="0 0 48 48" fill="none" class="hero-logo">
                    <path d="M12 28C12 28 12 20 18 18C24 16 36 16 42 22C42 22 42 30 36 32C30 34 18 34 12 28Z" fill="currentColor" opacity="0.2"/>
                    <path d="M14 22L12 16M17 20L15 14M20 18L18 12M23 17L21 11M26 17L24 11M29 18L27 12M32 20L30 14M35 22L33 16M38 24L36 18" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
                    <circle cx="40" cy="26" r="4" fill="currentColor" opacity="0.15"/>
                    <circle cx="38" cy="25" r="1.2" fill="currentColor"/>
                    <circle cx="42" cy="27" r="1.8" fill="currentColor"/>
                    <line x1="20" y1="32" x2="20" y2="35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <line x1="28" y1="32" x2="28" y2="35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </h1>
            <h2 class="hero-subtitle">The Intelligent Portfolio Companion</h2>
            <div class="hero-pill">
                <div class="hero-metric">
                    <div class="hero-metric-label">Portfolio Value</div>
                    <div class="hero-metric-value" id="heroCurrentValue">$786</div>
                </div>
                <div class="hero-divider"></div>
                <div class="hero-metric">
                    <div class="hero-metric-label target">2030 Target</div>
                    <div class="hero-metric-value" id="heroTargetValue">$1,510</div>
                </div>
            </div>
        </div>

        <div class="glass-card">
            <div class="portfolio-header">
                <h2>Stock Portfolio</h2>
                <div class="view-toggle" role="group" aria-label="Toggle portfolio view">
                    <button type="button" class="active" data-view-toggle="pie">Pie</button>
                    <button type="button" data-view-toggle="table">Table</button>
                </div>
            </div>
            <div class="portfolio-views" data-current-view="pie">
                <div class="portfolio-pie-view" id="stockPieView">
                    <div class="pie-chart-wrapper">
                        <div class="pie-chart" id="stockPieChart">
                            <div class="pie-center-label" id="stockPieCenter"></div>
                        </div>
                        <div class="pie-logo-ring" id="stockPieLogos"></div>
                    </div>
                    <ul class="chart-legend" id="stockPieLegend"></ul>
                </div>
                <div class="portfolio-table-view hidden" id="stockTableWrapper">
                    <table id="stockTable">
                        <thead>
                            <tr>
                                <th>Symbol</th>
                                <th>Shares</th>
                                <th>Current Price</th>
                                <th>Daily %</th>
                                <th>Current Value</th>
                                <th>Target Price</th>
                                <th>Target Value</th>
                                <th>Gain</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><a href="https://finance.yahoo.com/quote/PLTR" target="_blank">PLTR</a></td>
                                <td>0.4219</td>
                                <td>$178.04</td>
                                <td>$75</td>
                                <td>$450</td>
                                <td>$190</td>
                                <td>+153%</td>
                            </tr>
                            <tr>
                                <td><a href="https://finance.yahoo.com/quote/HOOD" target="_blank">HOOD</a></td>
                                <td>0.4129</td>
                                <td>$131.64</td>
                                <td>$54</td>
                                <td>$300</td>
                                <td>$124</td>
                                <td>+130%</td>
                            </tr>
                            <tr>
                                <td><a href="https://finance.yahoo.com/quote/NVDA" target="_blank">NVDA</a></td>
                                <td>0.2541</td>
                                <td>$189.49</td>
                                <td>$48</td>
                                <td>$500</td>
                                <td>$127</td>
                                <td>+165%</td>
                            </tr>
                            <tr>
                                <td><a href="https://finance.yahoo.com/quote/GOOGL" target="_blank">GOOGL</a></td>
                                <td>0.1485</td>
                                <td>$285.60</td>
                                <td>$42</td>
                                <td>$550</td>
                                <td>$82</td>
                                <td>+95%</td>
                            </tr>
                            <tr>
                                <td><a href="https://finance.yahoo.com/quote/TSLA" target="_blank">TSLA</a></td>
                                <td>0.1122</td>
                                <td>$448.80</td>
                                <td>$50</td>
                                <td>$800</td>
                                <td>$90</td>
                                <td>+80%</td>
                            </tr>
                            <tr>
                                <td><a href="https://finance.yahoo.com/quote/AAPL" target="_blank">AAPL</a></td>
                                <td>0.6338</td>
                                <td>$271.63</td>
                                <td>$172</td>
                                <td>$500</td>
                                <td>$317</td>
                                <td>+184%</td>
                            </tr>
                            <tr>
                                <td><a href="https://finance.yahoo.com/quote/SPY" target="_blank">SPY</a></td>
                                <td>0.3378</td>
                                <td>$671.99</td>
                                <td>$227</td>
                                <td>$1,100</td>
                                <td>$372</td>
                                <td>+64%</td>
                            </tr>
                            <tr>
                                <td><a href="https://finance.yahoo.com/quote/SBUX" target="_blank">SBUX</a></td>
                                <td>0.1432</td>
                                <td>$82.71</td>
                                <td>$12</td>
                                <td>$130</td>
                                <td>$19</td>
                                <td>+58%</td>
                            </tr>
                            <tr>
                                <td><a href="https://finance.yahoo.com/quote/V" target="_blank">V</a></td>
                                <td>0.2570</td>
                                <td>$336.34</td>
                                <td>$86</td>
                                <td>$550</td>
                                <td>$141</td>
                                <td>+64%</td>
                            </tr>
                            <tr>
                                <td><a href="https://www.coinbase.com/price/bitcoin" target="_blank">BTC-USD</a></td>
                                <td>0.0001927</td>
                                <td>$101,631</td>
                                <td>$20</td>
                                <td>$250,000</td>
                                <td>$48</td>
                                <td>+140%</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td><strong>Total</strong></td>
                                <td></td>
                                <td></td>
                                <td>‚Äî</td>
                                <td><strong>$786</strong></td>
                                <td></td>
                                <td><strong>$1,510</strong></td>
                                <td><strong>+92%</strong></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>

        <div class="glass-card market-insights-card" id="marketInsightsCard">
            <button class="market-insights-toggle" id="marketInsightsToggle" type="button" aria-expanded="false" aria-controls="marketInsightsContent">
                <span>Market Insights</span>
                <span class="market-insights-toggle-icon" aria-hidden="true">‚åÑ</span>
            </button>
            <div class="market-insights-content" id="marketInsightsContent">
                <div class="market-pulse">
                    <div class="market-pulse-item">
                        AI SURGE
                        <span>NVDA ¬∑ PLTR leading into Nov 19 earnings catalyst</span>
                    </div>
                    <div class="market-pulse-item">
                        CRYPTO HOLD
                        <span>BTC clings to $100K floor ¬∑ SOL steady mid-cycle</span>
                    </div>
                    <div class="market-pulse-item">
                        FED WATCH
                        <span>Rate-cut odds rising ¬∑ keeping SPY on 92% 2030 glide path</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="glass-card">
            <h2>Budget Breakdown</h2>
            <div class="payday-highlight">
                <div class="payday-title">Next Payday</div>
                <div id="paydayCountdown" class="payday-amount">Loading...</div>
                <div id="paydayDateLabel" class="payday-date"></div>
                <div class="payday-note">$1,060 monthly / ~$530 to invest</div>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Wallet / Savings (CAD)</td>
                        <td>$320</td>
                    </tr>
                    <tr>
                        <td>Income</td>
                        <td>$1,060</td>
                    </tr>
                    <tr>
                        <td>Food</td>
                        <td>-$300</td>
                    </tr>
                    <tr>
                        <td>Phone</td>
                        <td>-$130</td>
                    </tr>
                    <tr>
                        <td>Old phone (1 payment left)</td>
                        <td>-$177</td>
                    </tr>
                    <!-- <tr class="future-expense">
                        <td>Apple Watch (starts Nov)</td>
                        <td>-$33</td>
                    </tr> -->
                </tbody>
            </table>
        </div>

        <div class="glass-card">
            <h2>Debt Payoff Progress</h2>
            <div class="progress-summary">
                <div class="progress-labels">
                    <span>$0</span>
                    <span>$1,188 saved (24%)</span>
                    <span>$5,000</span>
                </div>
                <div class="progress-bar-track">
                    <div class="progress-bar-fill"></div>
                </div>
            </div>
            <table>
                <tbody>
                    <tr>
                        <td>Total Assets (Portfolio + Savings)</td>
                        <td id="totalAssetsCell">$867 USD + $446 CAD (~$321 USD) = ~$1,188 USD</td>
                    </tr>
                    <tr>
                        <td>Debt Payoff Goal</td>
                        <td>$5,000</td>
                    </tr>
                    <tr>
                        <td>Remaining to Goal</td>
                        <td id="remainingToGoalCell">$3,812</td>
                    </tr>
                    <tr class="hidden-row">
                        <td>Current Debt</td>
                        <td>$4,000</td>
                    </tr>
                    <tr>
                        <td>Monthly Payment Capacity</td>
                        <td>$453</td>
                    </tr>
                    <tr>
                        <td>iPhone Sale (when sold)</td>
                        <td>+$200</td>
                    </tr>
                    <tr>
                        <td>Months Until Debt-Free</td>
                        <td id="monthsToDebtFreeCell">8.4 months</td>
                    </tr>
                    <tr>
                        <td>Debt-Free Date</td>
                        <td id="debtFreeDateCell">July 2026</td>
                    </tr>
                    <tr>
                        <td>M5 MacBook Pro (16" M5 Pro)</td>
                        <td>Target: August 2026</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="glass-card">
            <h2>Summary</h2>
            <table>
                <tbody>
                    <tr>
                        <td><strong>Total Portfolio Value</strong></td>
                        <td id="summaryTotalPortfolio">$867</td>
                    </tr>
                    <tr>
                        <td><strong>2030 Target</strong></td>
                        <td id="summaryTargetPortfolio">$2,098</td>
                    </tr>
                    <tr>
                        <td><strong>Potential Gain</strong></td>
                        <td id="summaryPotentialGain">+$1,231 (+142%)</td>
                    </tr>
                    <tr>
                        <td><strong>Net Worth</strong></td>
                        <td id="summaryNetWorth">$1,188 - $5,000 = -$3,812</td>
                    </tr>
                    <tr>
                        <td><strong>Monthly Surplus (Nov)</strong></td>
                        <td>$1,060 - $607 = $453</td>
                    </tr>
                    <tr class="future-expense">
                        <td><strong>Monthly Surplus (Dec+)</strong></td>
                        <td>$1,060 - $430 = $630</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <footer class="site-footer">
        <a href="https://github.com/nulljosh/henry" target="_blank" rel="noopener">Built with <span class="heart">&hearts;</span> in Vancouver, BC</a><br>
        &copy; 2025-2026
    </footer>
</body>
</html>
